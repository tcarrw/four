<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>Four ¬∑ Rabbit Hole</title>
<style>
:root{--bg:#07080c;--ink:#fff;--line:rgba(255,255,255,.12);--pane:rgba(255,255,255,.08);--veil:rgba(12,12,18,.9);--accent:#7fe3ff;--mint:#86ffd6}
html,body{height:100%}
body{margin:0;color:var(--ink);font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;background:radial-gradient(1000px 700px at 50% 20%,#0f1324,#07080c 70%)}
.nav{position:fixed;left:14px;top:14px;display:flex;gap:8px;z-index:60}
.nav a{background:rgba(255,255,255,.08);border:1px solid rgba(255,255,255,.12);backdrop-filter:blur(8px);padding:8px 10px;border-radius:999px;color:#fff;text-decoration:none}
#schoolBadge{display:none}
.tunnel{position:fixed;inset:0;pointer-events:none;opacity:.5;mix-blend-mode:screen;background:radial-gradient(ellipse at center,rgba(127,227,255,.08),transparent 60%),repeating-radial-gradient(circle at 50% 45%,rgba(134,255,214,.06),rgba(134,255,214,.06) 6px,transparent 6px,transparent 12px);animation:descend 9s linear infinite}
@keyframes descend{0%{transform:translateY(0)}100%{transform:translateY(40px)}}
.lock{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:linear-gradient(180deg,rgba(0,0,0,.55),rgba(0,0,0,.7));z-index:10}
.card{width:min(640px,92vw);background:var(--veil);border:1px solid var(--line);border-radius:16px;padding:18px;backdrop-filter:blur(10px);text-align:center}
.hint{opacity:.8}
.input{background:transparent;border:none;border-bottom:1px solid var(--ink);outline:none;color:var(--ink);padding:6px 4px;width:100%;font-size:1rem;text-align:center}
.btn{background:var(--pane);border:1px solid var(--line);border-radius:10px;padding:10px 14px;color:var(--ink);cursor:pointer}
.app{min-height:100%;display:flex;align-items:center;justify-content:center;padding:24px}
.inner{width:min(900px,96vw)}
.header{display:flex;flex-wrap:wrap;gap:10px;align-items:center;justify-content:center;margin-bottom:12px}
.key{display:inline-flex;gap:6px;align-items:center;background:rgba(127,227,255,.15);border:1px solid rgba(127,227,255,.35);border-radius:999px;padding:6px 10px}
.pill{background:var(--pane);border:1px solid var(--line);border-radius:999px;padding:6px 10px}
.rule{height:1px;background:linear-gradient(90deg,transparent,rgba(255,255,255,.18),transparent);margin:10px 0}
.stage{display:grid;grid-template-columns:1fr;gap:12px}
.panel{background:rgba(12,12,18,.6);border:1px solid var(--line);border-radius:14px;padding:14px}
.title{font-weight:600;margin-bottom:6px}
.opts{display:flex;flex-wrap:wrap;gap:8px;margin-top:8px}
.opt{padding:8px 10px;border:1px solid var(--line);border-radius:10px;background:var(--pane);cursor:pointer}
.opt.correct{border-color:rgba(134,255,214,.65);box-shadow:0 0 0 2px rgba(134,255,214,.25) inset}
.opt.wrong{opacity:.6}
.progress{display:flex;gap:8px;justify-content:center;margin-top:10px}
.dot{width:10px;height:10px;border-radius:50%;background:rgba(255,255,255,.2);border:1px solid var(--line)}
.dot.on{background:var(--mint)}
.cta{display:none;margin-top:12px;justify-content:center}
.footer{position:fixed;left:14px;bottom:14px;font-size:.85rem;opacity:.65}
</style>
</head>
<body>
<div class="nav">
  <a href="https://center.plnt.earth" target="_blank">‚¨ÖÔ∏è Center</a>
  <a href="https://school.plnt.earth" target="_blank" id="schoolBadge">üéì School</a>
</div>
<div class="tunnel"></div>

<div id="lock" class="lock">
  <div class="card">
    <h2>Alice Key</h2>
    <p class="hint">This rabbit hole opens with a link from MirrorHoney. If you have the key, enter it.</p>
    <div style="margin:12px 0"><input id="keyInput" class="input" placeholder="enter key"></div>
    <button id="unlockBtn" class="btn">unlock</button>
  </div>
</div>

<div id="app" class="app" style="display:none">
  <div class="inner">
    <div class="header">
      <div class="key">üîë Alice</div>
      <div class="pill">holder: Kendyl (@kenneljustine)</div>
      <div class="pill" id="srcTag"></div>
    </div>
    <div class="rule"></div>

    <div class="stage">
      <div class="panel" data-step="1">
        <div class="title">Trial 1 ‚Äî Time</div>
        <div class="hint">Pick the phrase that keeps time honest.</div>
        <div class="opts">
          <div class="opt" data-a="wrong">‚ÄúWe have time to waste.‚Äù</div>
          <div class="opt" data-a="correct">‚ÄúI won‚Äôt spend time I don‚Äôt have.‚Äù</div>
          <div class="opt" data-a="wrong">‚ÄúTime works for me.‚Äù</div>
        </div>
      </div>

      <div class="panel" data-step="2">
        <div class="title">Trial 2 ‚Äî Door</div>
        <div class="hint">Which opens a door without breaking it?</div>
        <div class="opts">
          <div class="opt" data-a="wrong">Force</div>
          <div class="opt" data-a="correct">Permission</div>
          <div class="opt" data-a="wrong">Trick</div>
        </div>
      </div>

      <div class="panel" data-step="3">
        <div class="title">Trial 3 ‚Äî Mirror</div>
        <div class="hint">Choose the reflection that returns warmth.</div>
        <div class="opts">
          <div class="opt" data-a="wrong">‚ÄúSay it louder.‚Äù</div>
          <div class="opt" data-a="correct">‚ÄúCut clean. Set warm.‚Äù</div>
          <div class="opt" data-a="wrong">‚ÄúNo mirrors.‚Äù</div>
        </div>
      </div>
    </div>

    <div class="progress">
      <div class="dot" id="d1"></div>
      <div class="dot" id="d2"></div>
      <div class="dot" id="d3"></div>
    </div>

    <div class="cta" id="ctaWrap">
      <button id="schoolBtn" class="btn" style="background:linear-gradient(180deg,#a6ffe6,#7fe3ff);color:#0c1a17;border:1px solid rgba(0,0,0,.25)">follow the white rabbit ‚Üí school</button>
    </div>
  </div>
</div>

<div class="footer">‚ÄúIf you knew Time as well as I do, you wouldn‚Äôt talk about wasting it.‚Äù</div>

<script>
(function(){
  function pick(s,pat){var m=String(s||"").match(pat);return m?decodeURIComponent(m[1]):""}
  var src=pick(location.search,/[\?&]s=([^&]+)/), k=pick(location.hash,/[#?&]k=([^&]+)/);
  if(src) localStorage.setItem("four.src",JSON.stringify(src));
  if(k){
    if(!localStorage.getItem("four.key")) localStorage.setItem("four.key",JSON.stringify(k));
    localStorage.setItem("four.key.set","true");
    localStorage.setItem("four.unlock","true");
  }
  history.replaceState({},document.title,location.pathname);
})();
</script>

<script>
const lock=document.getElementById("lock"),app=document.getElementById("app"),srcTag=document.getElementById("srcTag"),schoolBadge=document.getElementById("schoolBadge")
const keyInput=document.getElementById("keyInput"),unlockBtn=document.getElementById("unlockBtn")
const dots=[document.getElementById("d1"),document.getElementById("d2"),document.getElementById("d3")]
const steps=[].slice.call(document.querySelectorAll(".panel[data-step]"))
const ctaWrap=document.getElementById("ctaWrap"),schoolBtn=document.getElementById("schoolBtn")
function jget(k,def){try{return JSON.parse(localStorage.getItem(k)||def)}catch(e){return JSON.parse(def)}}
function show(){lock.style.display="none";app.style.display="flex";srcTag.textContent=jget("four.src","\"mh.four\"")}
function tryUnlock(v){var expect=jget("four.key","");if(expect&&v===expect){localStorage.setItem("four.unlock","true");show();return true}return false}
function mark(i,on){dots[i-1].classList.toggle("on",on)}
function setStepDone(i){localStorage.setItem("four.step."+i,"true");mark(i,true)}
function isDone(i){return localStorage.getItem("four.step."+i)==="true"}
function checkAll(){var ok=isDone(1)&&isDone(2)&&isDone(3);if(ok){ctaWrap.style.display="flex";localStorage.setItem("four.hole.done","true");try{document.getElementById("schoolBadge").style.display="inline-flex"}catch(e){} }}
function genCode(){return Math.random().toString(36).slice(2,6)+"-"+Math.random().toString(36).slice(2,6)+"-"+Math.random().toString(36).slice(2,6)}
function schoolUrl(k){return "https://school.plnt.earth/?s=four.rabbit#k="+encodeURIComponent(k)}
steps.forEach(function(panel){
  panel.addEventListener("click",function(e){
    var t=e.target;if(!t.classList.contains("opt"))return;
    if(t.getAttribute("data-a")==="correct"){t.classList.add("correct");setStepDone(Number(panel.getAttribute("data-step")));checkAll()}
    else{t.classList.add("wrong")}
  })
})
unlockBtn.addEventListener("click",function(){var v=(keyInput.value||"").trim();if(tryUnlock(v)){keyInput.value=""}})
window.addEventListener("load",function(){
  if(localStorage.getItem("four.unlock")) show();
  [1,2,3].forEach(function(i){if(isDone(i))mark(i,true)});
  if(localStorage.getItem("four.hole.done")){ctaWrap.style.display="flex";try{document.getElementById("schoolBadge").style.display="inline-flex"}catch(e){} }
})
schoolBtn.addEventListener("click",function(){
  var k=genCode();location.href=schoolUrl(k)
})
</script>
</body>
</html>
