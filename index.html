<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>four.plnt.earth — Begin</title>
<style>
  html, body {
    margin:0; padding:0;
    background:#ffffff;
    height:100%; width:100%;
    overflow:hidden;
    font-family:-apple-system, BlinkMacSystemFont, sans-serif;
    -webkit-tap-highlight-color:transparent;
  }

  .header {
    position:absolute;
    top:20px;
    left:50%;
    transform:translateX(-50%);
    font-size:15px;
    font-weight:500;
    letter-spacing:0.7px;
    color:rgba(0,0,0,0.55);
    user-select:none;
    pointer-events:none;
  }

  .root {
    position:relative;
    height:100vh;
    width:100%;
    display:flex;
    align-items:center;
    justify-content:center;
    transition:transform 1.4s ease-out;
  }

  #fieldLine {
    position:absolute;
    top:0; bottom:0; left:50%;
    width:0.2px;
    background:rgba(0,0,0,0.28);
    transform:translateX(-50%);
    opacity:0;
    transition:opacity 0.9s ease, width 0.7s ease-out;
  }

  .breath-expand {
    width:4px !important;
  }

  #videoWrap {
    opacity:0;
    pointer-events:none;
    width:100%;
    max-width:880px;
    padding:0 16px;
    transition:opacity 1.05s ease-out;
  }

  .video-visible {
    opacity:1 !important;
    pointer-events:auto !important;
  }

  .video-frame {
    position:relative;
    padding-bottom:56.25%;
    height:0;
  }

  .video-frame iframe {
    position:absolute;
    top:0; left:0;
    width:100%; height:100%;
    border:0;
  }

  #vectorLine {
    position:fixed;
    bottom:0; left:0; right:0;
    height:1.5px;
    background:#d200ff;
    opacity:0;
    transition:opacity 0.45s linear;
  }

  .vector-live #vectorLine {
    opacity:1;
  }

  .reflection {
    position:absolute;
    top:24%;
    left:50%;
    transform:translateX(-50%);
    font-size:14px;
    color:rgba(0,0,0,0.30);
    opacity:0;
    transition:opacity 0.25s ease-out, color 0.25s linear;
    user-select:none;
    pointer-events:none;
  }
</style>
</head>

<body>
<div class="header">Four beats. One motion.</div>
<div class="root" id="root">

  <div class="reflection" id="reflection"></div>
  <div id="fieldLine" style="position:absolute; top:60px; left:0; right:0; height:0.2px; background:rgba(0,0,0,0.28); opacity:0; transition:opacity 0.9s ease, height 0.7s ease-out;"><\/div>

  <div id="videoWrap">
    <div class="video-frame">
      <iframe
        id="berghainVideo"
        src="https://www.youtube.com/embed/htQBS2Ikz6c?rel=0&showinfo=0&enablejsapi=1"
        allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture"
        allowfullscreen>
      </iframe>
    </div>
  </div>

  <div id="vectorLine"></div>
</div>

<script>
// FINAL CLEAN SCRIPT — four.plnt.earth
// Fully rebuilt with correct timing map + clear beats + Option C

const fieldLine = document.getElementById('fieldLine');
const videoWrap = document.getElementById('videoWrap');
const root = document.getElementById('root');
const reflection = document.getElementById('reflection');

// --- Reflection ---
function showReflection(text, replay=true) {
  reflection.textContent = text;
  reflection.style.opacity = "1";

  if (replay) {
    setTimeout(() => { reflection.style.color = "rgba(0,0,0,0.36)"; }, 500);
    setTimeout(() => { reflection.style.color = "rgba(0,0,0,0.30)"; }, 900);
  }

  setTimeout(() => {
    reflection.style.opacity = "0";
  }, 1200);
}

// === BEAT 1 — STILLNESS ===
setTimeout(() => {
  fieldLine.style.opacity = "1";
  setTimeout(() => { fieldLine.style.opacity = "0"; }, 300);
}, 900);

setTimeout(() => {
  showReflection("Stillness", true);
}, 1200);

// === BEAT 2 — READINESS ===
setTimeout(() => {
  showReflection("Readiness", true);
  enableTap();
}, 2400);

// === BEAT 3 — INTENTION ===
function enableTap() {
  root.addEventListener('click', handleTap, { once:true });
}

function handleTap() {
  videoWrap.classList.add('video-visible');
  showReflection("Intention", true);
}

// === BEAT 4 — ALIGNMENT ===
window.addEventListener("message", function (event) {
  try {
    if (typeof event.data === "string" && event.data.includes('"playerState":1')) {
      activateVector();
    }
  } catch(e){}
});

function activateVector() {
  setTimeout(() => {
    showReflection("Alignment", true);
    root.style.transform = "perspective(900px) rotateX(3.6deg)";

    setTimeout(() => {
      root.style.transform = "none";
    }, 2000);

  }, 1000);
}
</script>

</body>
</html>
