<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>four.plnt.earth — Begin</title>

<style>
  html, body {
    margin:0; padding:0;
    background:#ffffff;
    height:100%; width:100%;
    overflow:hidden;
    font-family:-apple-system, BlinkMacSystemFont, sans-serif;
    -webkit-tap-highlight-color:transparent;
  }

  /* Pre-brief header */
  .header {
    position:absolute;
    top:20px;
    left:50%;
    transform:translateX(-50%);
    font-size:14px;
    font-weight:500;
    letter-spacing:0.6px;
    color:rgba(0,0,0,0.55);
    user-select:none;
    pointer-events:none;
  }

  /* Main container */
  .root {
    position:relative;
    height:100vh;
    width:100%;
    display:flex;
    align-items:center;
    justify-content:center;
    transition:transform 1s ease-out;
  }

  /* Greta — Field Line (Beat 1 / Beat 2 pulse) */
  #fieldLine {
    position:absolute;
    top:0; bottom:0; left:50%;
    width:0.2px;
    background:rgba(0,0,0,0.25);
    transform:translateX(-50%);
    opacity:0;
    transition:
      opacity 0.6s ease,
      width 0.5s ease-out;
  }
  .breath-expand {
    width:3px !important;
  }

  /* Dua — Video Reveal */
  #videoWrap {
    opacity:0;
    pointer-events:none;
    width:100%;
    max-width:800px;
    padding:0 16px;
    transition:opacity 0.55s ease-out;
  }
  .video-visible {
    opacity:1 !important;
    pointer-events:auto !important;
  }

  .video-frame {
    position:relative;
    padding-bottom:56.25%;
    height:0;
  }
  .video-frame iframe {
    position:absolute;
    top:0; left:0;
    width:100%; height:100%;
    border:0;
  }

  /* Dua — Vector Line (Beat 4) */
  #vectorLine {
    position:fixed;
    bottom:0; left:0; right:0;
    height:1px;
    background:#d200ff;
    opacity:0;
    transition:opacity 0.4s linear;
  }
  .vector-live #vectorLine {
    opacity:1;
  }

  /* Marina — Reflections (600ms) */
  .reflection {
    position:absolute;
    top:12%;
    left:50%;
    transform:translateX(-50%);
    font-size:13px;
    color:rgba(0,0,0,0.30);
    opacity:0;
    transition:opacity 0.2s ease-out;
    pointer-events:none;
    user-select:none;
    letter-spacing:0.4px;
  }
</style>
</head>

<body>

<div class="header">Four beats. One motion.</div>

<div class="root" id="root">

  <div class="reflection" id="reflection"></div>

  <div id="fieldLine"></div>

  <div id="videoWrap">
    <div class="video-frame">
      <iframe
        id="berghainVideo"
        src="https://www.youtube.com/embed/htQBS2Ikz6c?rel=0&showinfo=0"
        allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture"
        allowfullscreen>
      </iframe>
    </div>
  </div>

  <div id="vectorLine"></div>

</div>

<script>
/* ================================================================
   FOUR.PLNT.EARTH — Clean Motion Instrument
   Greta (Field), Dua (Vector), Marina (Reflection), Dagny (Lightness),
   Sigrid (Replay-Eligible Micro-Clarity)
   ================================================================ */

const fieldLine = document.getElementById('fieldLine');
const videoWrap = document.getElementById('videoWrap');
const root = document.getElementById('root');
const reflection = document.getElementById('reflection');

/* Marina — show reflection label */
function showReflection(text, eligibleReplay=true) {
  reflection.textContent = text;
  reflection.style.opacity = "1";

  /* Sigrid — tiny replay lift if beat was clean */
  if (eligibleReplay) {
    setTimeout(() => { 
      reflection.style.color = "rgba(0,0,0,0.34)"; 
    }, 450); 

    setTimeout(() => { 
      reflection.style.color = "rgba(0,0,0,0.30)"; 
    }, 580);
  }

  setTimeout(() => {
    reflection.style.opacity = "0";
  }, 600);
}

/* ======================== BEAT 1 — STILLNESS ======================== */
setTimeout(() => {
  fieldLine.style.opacity = "1";
  showReflection("Stillness", true);
}, 200);

/* ======================== BEAT 2 — READINESS ======================== */
setTimeout(() => {
  fieldLine.classList.add('breath-expand');
  showReflection("Readiness", true);

  setTimeout(() => {
    fieldLine.classList.remove('breath-expand');
    enableTap();
  }, 700);

}, 1200);

/* ======================== BEAT 3 — INTENTION ======================== */
function enableTap() {
  root.addEventListener('click', handleTap, { once:true });
}

function handleTap() {
  fieldLine.style.opacity = "0";
  videoWrap.classList.add('video-visible');
  showReflection("Intention", true);
}

/* ======================== BEAT 4 — ALIGNMENT ======================== */
window.addEventListener("message", function (event) {
  try {
    if (typeof event.data === "string" && event.data.includes('"playerState":1')) {
      activateVector();
    }
  } catch(e){}
});

function activateVector() {
  showReflection("Alignment", true);

  root.classList.add('vector-live');
  root.style.transform = "perspective(800px) rotateX(1.2deg)";

  setTimeout(() => {
    root.style.transform = "none";
    root.classList.remove('vector-live');
  }, 1000);
}
</script>

</body>
</html>
